<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Daily News Dashboard</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet">
  <style>
{% include "partials/index.css" %}
  </style>
</head>

<body>

  <div class="ambient-blob"></div>

  <div class="layout">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="logo">News<span>Flow</span></div>
      <div class="update-time">ÊúÄÁµÇÊõ¥Êñ∞: {{ updated_at }}</div>

      <div class="nav-section-label">„É°„Ç§„É≥„É°„Éã„É•„Éº</div>
      <button class="nav-item category-filter sidebar-category-filter active" data-category="all" aria-pressed="true">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="7" height="7" rx="1" />
          <rect x="14" y="3" width="7" height="7" rx="1" />
          <rect x="3" y="14" width="7" height="7" rx="1" />
          <rect x="14" y="14" width="7" height="7" rx="1" />
        </svg>
        „Åô„Åπ„Å¶
        <span class="count">{{ overall_total }}</span>
      </button>

      <div class="nav-section-label" data-role="category-label">„Ç´„ÉÜ„Ç¥„É™</div>
      {%- for category in display_categories %}
      <button class="nav-item category-filter sidebar-category-filter" data-category="{{ category.label }}" aria-pressed="false">
        <span class="dot" style="background:{{ category.color }}"></span>
        {{ category.label }}
        <span class="count">{{ category.total }}</span>
      </button>
      {%- endfor %}

      <div class="nav-section-label">„ÇΩ„Éº„Çπ‰∏ÄË¶ß</div>
      {% for site in all_sites %}
      <a href="{{ site.site_url }}" target="_blank" rel="noopener" class="nav-item source-list-link" style="font-size:12px">
        <span class="dot" style="background:{{ site.accent_color }};width:6px;height:6px"></span>
        {{ site.name }}
      </a>
      {% endfor %}

      <div class="sidebar-footer">
        Daily News Dashboard<br>
        Powered by RSS + xAI + GitHub Actions
      </div>
    </aside>

    <!-- MAIN -->
    <main class="main">
      <!-- Main Tabs -->
      <div class="main-tabs" role="tablist" aria-label="Main content tabs">
        <button type="button" id="tab-btn-news" class="main-tab active" data-tab="news" role="tab" aria-selected="true"
          aria-controls="tab-news">Today's News</button>
        <button type="button" id="tab-btn-ranking" class="main-tab" data-tab="ranking" role="tab" aria-selected="false"
          aria-controls="tab-ranking">Rankings</button>
        <button type="button" id="tab-btn-sns" class="main-tab" data-tab="sns" role="tab" aria-selected="false"
          aria-controls="tab-sns">SNS</button>
      </div>

      <div class="tab-indicator" id="tab-indicator">
        <span class="tab-indicator-dot active" data-tab="news"></span>
        <span class="tab-indicator-dot" data-tab="ranking"></span>
        <span class="tab-indicator-dot" data-tab="sns"></span>
      </div>
      <div class="swipe-hint hidden" id="swipe-hint" aria-hidden="true">‚Üê „Çπ„ÉØ„Ç§„Éó„ÅßÂàá„ÇäÊõø„Åà ‚Üí</div>

      <div class="mobile-category-wrap" data-role="mobile-category-wrap">
        <div class="mobile-category-scroll">
          <button type="button" class="mobile-category-filter category-filter active" data-category="all" aria-pressed="true">All ¬∑ {{ overall_total }}</button>
          {%- for category in display_categories %}
          <button type="button" class="mobile-category-filter category-filter" data-category="{{ category.label }}" aria-pressed="false">
            {{ category.label }} ¬∑ {{ category.total }}
          </button>
          {%- endfor %}
        </div>
      </div>

      <!-- Swipe Container -->
      <div class="swipe-container" id="swipe-container">

      <!-- News Tab Content -->
      <div class="swipe-slide tab-content active" id="tab-news" role="tabpanel" aria-labelledby="tab-btn-news">
      {%- for category in display_categories %}
      <div class="category-section" data-cat="{{ category.label }}">
        <div class="section-header">
          <div class="section-accent" style="background: {{ category.color }};"></div>
          <div class="section-title">{{ category.label }}</div>
          <div class="section-count">{{ category.source_count }} sources ¬∑ {{ category.total }} articles</div>
        </div>
        <div class="news-grid">
          {%- for site in category.sites %}
          <div class="news-card">
            <div class="card-accent-stripe" style="background: {{ site.accent_color }};"></div>
            <div class="card-header">
              <div class="source-icon" style="background: {{ site.icon_gradient }};">{{ site.icon }}</div>
              <a href="{{ site.site_url }}" target="_blank" rel="noopener" class="source-info">
                <div class="source-name">{{ site.name }}</div>
                <div class="source-url">{{ site.domain }}</div>
              </a>
              <div class="source-badge" style="background: {{ site.accent_color }}11; color: {{ site.accent_color }};">{{ site.badge }}</div>
            </div>
            <ul class="card-headlines">
              {%- for item in site["items"] %}
              <li>
                <svg class="headline-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="9 18 15 12 9 6" />
                </svg>
                <div class="headline-content">
                  <a href="{{ item.link }}" target="_blank" rel="noopener">{{ item.title }}</a>
                </div>
              </li>
              {%- endfor %}
            </ul>
          </div>
          {%- endfor %}
        </div>
      </div>
      {%- endfor %}
      </div>

      <!-- Rankings Tab Content -->
      <div class="swipe-slide tab-content" id="tab-ranking" role="tabpanel" aria-labelledby="tab-btn-ranking">
        <div class="section-header">
          <div class="section-accent" style="background: var(--accent-tech);"></div>
          <div class="section-title">Popular Rankings</div>
          <div class="section-count">
            {{ ranking_status.success_sources }} / {{ ranking_status.total_sources }} sources
            {%- if ranking_status.failed_sources > 0 %} ¬∑ {{ ranking_status.failed_sources }} failed{%- endif %}
          </div>
        </div>
        {%- if ranking_data %}
        <div class="ranking-grid">
          {%- for rsite in ranking_data %}
          <div class="ranking-card">
            <div class="card-accent-stripe" style="background: {{ rsite.accent_color }};"></div>
            <div class="card-header">
              <div class="source-icon" style="background: {{ rsite.icon_gradient }};">{{ rsite.icon }}</div>
              <a href="{{ rsite.site_url }}" target="_blank" rel="noopener" class="source-info">
                <div class="source-name">{{ rsite.name }}</div>
                <div class="source-url">{{ rsite.domain }}</div>
              </a>
              <div class="source-badge" style="background: {{ rsite.accent_color }}11; color: {{ rsite.accent_color }};">{{ rsite.badge }}</div>
            </div>
            <ol class="ranking-list">
              {%- for item in rsite["items"] %}
              <li>
                <span class="ranking-number {% if loop.index == 1 %}rank-1{% elif loop.index == 2 %}rank-2{% elif loop.index == 3 %}rank-3{% else %}rank-other{% endif %}">{{ loop.index }}</span>
                <a href="{{ item.link }}" target="_blank" rel="noopener">{{ item.title }}</a>
              </li>
              {%- endfor %}
            </ol>
          </div>
          {%- endfor %}
        </div>
        {%- else %}
        <div class="ranking-empty">
          No ranking data available<br>
          <small>Last checked: {{ ranking_status.updated_at }}{% if ranking_status.failed_sources > 0 %} ¬∑ {{ ranking_status.failed_sources }} sources failed{% endif %}</small>
        </div>
        {%- endif %}
      </div>

      <!-- SNS Tab Content -->
      <div class="swipe-slide tab-content" id="tab-sns" role="tabpanel" aria-labelledby="tab-btn-sns">
        <div class="section-header">
          <div class="section-accent" style="background: #1d9bf0;"></div>
          <div class="section-title">ùïè Trending Posts</div>
          <div class="section-count">{{ sns_data | length }} categories</div>
        </div>
        {%- if sns_data %}
        <div class="sns-grid">
          {%- for cat in sns_data %}
          <div class="news-card">
            <div class="card-accent-stripe" style="background: {{ cat.accent_color }};"></div>
            <div class="card-header">
              <div class="source-icon" style="background: {{ cat.icon_gradient }};">ùïè</div>
              <div class="source-info" style="cursor:default">
                <div class="source-name">{{ cat.label }}</div>
                <div class="source-url">x.com</div>
              </div>
              <div class="source-badge" style="background: {{ cat.accent_color }}11; color: {{ cat.accent_color }};">{{ cat.badge }}</div>
            </div>
            <ul class="card-headlines sns-post-list">
              {%- for post in cat.posts %}
              <li>
                <svg class="headline-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="9 18 15 12 9 6" />
                </svg>
                <div class="headline-content">
                  {%- if post.url %}
                  <a href="{{ post.url }}" target="_blank" rel="noopener">
                    <span class="sns-author">{{ post.author }}</span>
                    <span class="sns-text">{{ post.content }}</span>
                  </a>
                  {%- else %}
                  <span class="sns-no-link">
                    <span class="sns-author">{{ post.author }}</span>
                    <span class="sns-text">{{ post.content }}</span>
                  </span>
                  {%- endif %}
                </div>
              </li>
              {%- endfor %}
              {%- if not cat.posts %}
              <li style="padding:20px 24px;color:var(--text-muted);font-size:13px;">„Éá„Éº„Çø„ÇíÂèñÂæó„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„Åü</li>
              {%- endif %}
            </ul>
          </div>
          {%- endfor %}
        </div>
        {%- else %}
        <div class="ranking-empty">
          No SNS data available
        </div>
        {%- endif %}
      </div>
      </div> <!-- End swipe-container -->

    </main>
  </div>

  <script>
{% include "partials/index.js" %}
  </script>
</body>

</html>
